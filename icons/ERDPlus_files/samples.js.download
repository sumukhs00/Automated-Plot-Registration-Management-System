/*jslint browser:true */
'use strict';

window.erd = window.erd || {};

(function() {

  erd.samples = {
    erd1: '{"version":1,"created":1417301189727,"www":"erdplus.com","shapes":[{"type":"Entity","details":{"name":"entity1","type":"regular","x":726,"y":83,"id":13}},{"type":"Entity","details":{"name":"entity2","type":"weak","x":110,"y":350,"id":14}},{"type":"Entity","details":{"name":"entity3","type":"associative","x":697,"y":354,"id":15}},{"type":"Entity","details":{"name":"entity4","type":"regular","x":130,"y":78,"id":16}},{"type":"Attribute","details":{"name":"attribute1","isDerived":false,"isMultivalued":false,"isOptional":false,"isComposite":false,"isUnique":false,"x":637,"y":158,"id":1}},{"type":"Attribute","details":{"name":"attribute2","isDerived":true,"isMultivalued":false,"isOptional":false,"isComposite":false,"isUnique":false,"x":842,"y":127,"id":2}},{"type":"Attribute","details":{"name":"attribute3","isDerived":false,"isMultivalued":true,"isOptional":false,"isComposite":false,"isUnique":false,"x":808,"y":224,"id":3}},{"type":"Attribute","details":{"name":"attribute4","isDerived":false,"isMultivalued":false,"isOptional":true,"isComposite":false,"isUnique":false,"x":763,"y":169,"id":4}},{"type":"Attribute","details":{"name":"attribute5","isDerived":false,"isMultivalued":false,"isOptional":false,"isComposite":true,"isUnique":false,"x":118,"y":277,"id":5}},{"type":"Attribute","details":{"name":"attribute6","isDerived":false,"isMultivalued":false,"isOptional":false,"isComposite":false,"isUnique":true,"x":687,"y":215,"id":6}},{"type":"Attribute","details":{"name":"attribute7","isDerived":false,"isMultivalued":false,"isOptional":false,"isComposite":false,"isUnique":false,"x":190,"y":226,"id":7}},{"type":"Attribute","details":{"name":"attribute8","isDerived":false,"isMultivalued":false,"isOptional":false,"isComposite":false,"isUnique":false,"x":85,"y":219,"id":8}},{"type":"Attribute","details":{"name":"attribute9","isDerived":false,"isMultivalued":false,"isOptional":false,"isComposite":true,"isUnique":false,"x":396,"y":188,"id":9}},{"type":"Attribute","details":{"name":"attribute10","isDerived":false,"isMultivalued":false,"isOptional":false,"isComposite":false,"isUnique":false,"x":498,"y":166,"id":10}},{"type":"Attribute","details":{"name":"attribute11","isDerived":false,"isMultivalued":false,"isOptional":false,"isComposite":false,"isUnique":false,"x":500,"y":213,"id":11}},{"type":"Attribute","details":{"name":"attribute12","isDerived":false,"isMultivalued":false,"isOptional":false,"isComposite":false,"isUnique":false,"x":407,"y":279,"id":12}},{"type":"Relationship","details":{"x":458,"y":82,"name":"relationship1","isIdentifying":false,"slots":[{"minimum":0,"maximum":1,"participation":"mandatory","cardinality":"many","role":"aaa","entityId":13},{"minimum":0,"maximum":1,"participation":"mandatory","cardinality":"one","role":"bbb","entityId":16}],"id":27}},{"type":"Relationship","details":{"x":429,"y":348,"name":"relationship2","isIdentifying":true,"slots":[{"minimum":0,"maximum":1,"participation":"optional","cardinality":"many","role":"ccc","entityId":14},{"minimum":0,"maximum":1,"participation":"optional","cardinality":"one","role":"ddd","entityId":15}],"id":28}}],"connectors":[{"type":"Connector","details":{"id":17},"source":1,"destination":13},{"type":"Connector","details":{"id":18},"source":2,"destination":13},{"type":"Connector","details":{"id":19},"source":3,"destination":13},{"type":"Connector","details":{"id":20},"source":4,"destination":13},{"type":"Connector","details":{"id":21},"source":6,"destination":13},{"type":"Connector","details":{"id":22},"source":5,"destination":14},{"type":"Connector","details":{"id":23},"source":7,"destination":5},{"type":"Connector","details":{"id":24},"source":8,"destination":5},{"type":"Connector","details":{"id":25},"source":10,"destination":9},{"type":"Connector","details":{"id":26},"source":11,"destination":9},{"type":"Connector","details":{"id":29},"source":12,"destination":28},{"type":"RelationshipConnector","details":{"id":30},"source":13,"destination":27},{"type":"RelationshipConnector","details":{"id":31},"source":16,"destination":27},{"type":"RelationshipConnector","details":{"id":32},"source":14,"destination":28},{"type":"RelationshipConnector","details":{"id":33},"source":15,"destination":28}]}',
    erd2: '{"version":1,"created":1418097001461,"www":"erdplus.com","shapes":[{"type":"Entity","details":{"name":"Entity","type":"regular","x":107,"y":67,"id":44}},{"type":"Entity","details":{"name":"Entity","type":"regular","x":100,"y":315,"id":45}},{"type":"Entity","details":{"name":"Entity","type":"regular","x":324,"y":101,"id":46}},{"type":"Entity","details":{"name":"Entity","type":"regular","x":464,"y":314,"id":47}},{"type":"Entity","details":{"name":"Entity","type":"regular","x":853,"y":74,"id":48}},{"type":"Entity","details":{"name":"Entity","type":"regular","x":852,"y":272,"id":49}},{"type":"Relationship","details":{"name":"Relationship","isIdentifying":false,"x":1027,"y":155,"slots":[{"participation":"unspecified","cardinality":"unspecified","role":"","entityId":49},{"participation":"unspecified","cardinality":"unspecified","role":"","entityId":0}],"id":50}},{"type":"Relationship","details":{"name":"Relationship","isIdentifying":false,"x":262,"y":197,"slots":[{"participation":"unspecified","cardinality":"unspecified","role":"","entityId":47},{"participation":"unspecified","cardinality":"unspecified","role":"","entityId":46}],"id":51}},{"type":"Relationship","details":{"name":"Relationship","isIdentifying":false,"x":669,"y":317,"slots":[{"participation":"unspecified","cardinality":"unspecified","role":"","entityId":47},{"participation":"unspecified","cardinality":"unspecified","role":"","entityId":0}],"id":52}},{"type":"Relationship","details":{"name":"Relationship","isIdentifying":false,"x":1069,"y":338,"slots":[{"participation":"unspecified","cardinality":"unspecified","role":"","entityId":49},{"participation":"unspecified","cardinality":"unspecified","role":"","entityId":0}],"id":53}},{"type":"Relationship","details":{"name":"Relationship","isIdentifying":false,"x":104,"y":176,"slots":[{"participation":"unspecified","cardinality":"unspecified","role":"","entityId":44},{"participation":"unspecified","cardinality":"unspecified","role":"","entityId":45}],"id":54}},{"type":"Relationship","details":{"name":"Relationship","isIdentifying":false,"x":276,"y":296,"slots":[{"participation":"unspecified","cardinality":"unspecified","role":"","entityId":45},{"participation":"unspecified","cardinality":"unspecified","role":"","entityId":47}],"id":57}},{"type":"Relationship","details":{"name":"Relationship","isIdentifying":false,"x":487,"y":194,"slots":[{"participation":"unspecified","cardinality":"unspecified","role":"","entityId":46},{"participation":"unspecified","cardinality":"unspecified","role":"","entityId":47}],"id":63}},{"type":"Relationship","details":{"name":"Relationship","isIdentifying":false,"x":658,"y":91,"slots":[{"participation":"unspecified","cardinality":"unspecified","role":"","entityId":46},{"participation":"unspecified","cardinality":"unspecified","role":"","entityId":48}],"id":66}}],"connectors":[{"type":"RelationshipConnector","details":{"id":55},"source":44,"destination":54},{"type":"RelationshipConnector","details":{"id":56},"source":45,"destination":54},{"type":"RelationshipConnector","details":{"id":58},"source":45,"destination":57},{"type":"RelationshipConnector","details":{"id":59},"source":47,"destination":57},{"type":"RelationshipConnector","details":{"id":60},"source":47,"destination":52},{"type":"RelationshipConnector","details":{"id":61},"source":47,"destination":51},{"type":"RelationshipConnector","details":{"id":62},"source":46,"destination":51},{"type":"RelationshipConnector","details":{"id":64},"source":46,"destination":63},{"type":"RelationshipConnector","details":{"id":65},"source":47,"destination":63},{"type":"RelationshipConnector","details":{"id":67},"source":46,"destination":66},{"type":"RelationshipConnector","details":{"id":68},"source":48,"destination":66},{"type":"RelationshipConnector","details":{"id":69},"source":49,"destination":50},{"type":"RelationshipConnector","details":{"id":70},"source":49,"destination":53}]}'
  };

  erd.samples.createDimension = function(stage) {
    var dimension1 = stage.factory.dimension({
      "name":"Region",
      "x":200,
      "y":150,
      "id":1,
      "attributes":[{
          "names":["RegionID"],
          "optional":false,
          "fk":false,
          "pk":true,
          "id":1
        }, {
          "names":["RegionName"],
          "optional":false,
          "fk":false,
          "pk":false,
          "id":2
        }
      ]
    });
    var dimension2 = stage.factory.dimension({
      "name":"Store",
      "x":500,
      "y":120,
      "id":2,
      "attributes":[{
          "names":["StoreID"],
          "pk":true,
          "fk":false,
          "optional":false,
          "id":1
        }, {
          "names":["StoreZip"],
          "pk":false,
          "fk":false,
          "optional":false,
          "id":2
        }
      ]
    });
    var fact = stage.factory.fact({
      "name":"Employee",
      "x":800,
      "y":150,
      "id":3,
      "attributes":[{
          "names":["First Name", "Last Name"],
          "pk":true,
          "fk":false,
          "optional":false,
          "id":1
        }, {
          "names":["Wage"],
          "pk":false,
          "fk":false,
          "optional":false,
          "id":2
        }
      ]
    });

    stage.addItem(dimension1);
    stage.addItem(dimension2);
    stage.addItem(fact);
    // stage.connect.items(dimension1, dimension2);
    // stage.connect.items(dimension1, dimension2);
    // stage.connect.items(dimension1, dimension1);
    // stage.connect.items(fact, dimension2);
  };

  erd.samples.createRelational = function(stage) {
    var region = stage.factory.table({
      "name":"Region",
      "x":200,
      "y":150,
      "id":1,
      "attributes":[{
          "names":["RegionID"],
          "optional":false,
          "fk":false,
          "pk":true,
          "id":1
        }, {
          "names":["RegionName"],
          "optional":false,
          "fk":false,
          "pk":false,
          "id":2
        }
      ]
    });
    region.details.uniqueGroups = [[1], [1,2], [2,3], [1,3]];

    var store = stage.factory.table({
      "name":"Store",
      "x":500,
      "y":120,
      "id":2,
      "attributes":[{
          "names":["StoreID"],
          "pk":true,
          "fk":false,
          "optional":false,
          "id":1
        }, {
          "names":["StoreZip"],
          "pk":false,
          "fk":false,
          "optional":false,
          "id":2
        }
      ]
    });
    store.details.uniqueGroups = [[1], [1,2], [2,3], [1,3]];

    var employee = stage.factory.table({
      "name":"Employee",
      "x":800,
      "y":150,
      "id":3
    });
    employee.addAttribute({
      "names":["First Name"],
      "pk":true,
      "fk":false,
      "optional":false
    });
    employee.addAttribute({
      "names":["Last Name"],
      "pk":true,
      "fk":false,
      "optional":false
    });
    employee.addAttribute({
      "names":["Wage"],
      "pk":false,
      "fk":false,
      "optional":false
    });
    employee.details.uniqueGroups = [[1], [1,2], [2,3], [1,3]];

    stage.addItem(region);
    stage.addItem(store);
    stage.addItem(employee);
    stage.connect.items(employee, store);
    store.details.attributes[2].pk = true;

    stage.connect.items(region, store);
    stage.connect.items(store, region);
    stage.connect.items(region, region);
  };

  erd.samples.create = function(stage) {

    var attribute1 = stage.factory.attribute( { x: 225, y: 100, name: 'attribute1', isDerived: false, isMultivalued: false, isOptional: false, isComposite: false, isUnique: false } );
    var attribute2 = stage.factory.attribute( { x: 225, y: 100, name: 'attribute2', isDerived: true,  isMultivalued: false, isOptional: false, isComposite: false, isUnique: false } );
    var attribute3 = stage.factory.attribute( { x: 225, y: 100, name: 'attribute3', isDerived: false, isMultivalued: true,  isOptional: false, isComposite: false, isUnique: false } );
    var attribute4 = stage.factory.attribute( { x: 225, y: 100, name: 'attribute4', isDerived: false, isMultivalued: false, isOptional: true,  isComposite: false, isUnique: false } );
    var attribute5 = stage.factory.attribute( { x: 225, y: 100, name: 'attribute5', isDerived: false, isMultivalued: false, isOptional: false, isComposite: true,  isUnique: false } );
    var attribute6 = stage.factory.attribute( { x: 225, y: 100, name: 'attribute6', isDerived: false, isMultivalued: false, isOptional: false, isComposite: false, isUnique: true  } );
    var attribute7 = stage.factory.attribute( { x: 225, y: 100, name: 'attribute7', isDerived: false, isMultivalued: false, isOptional: false, isComposite: false, isUnique: false } );
    var attribute8 = stage.factory.attribute( { x: 225, y: 100, name: 'attribute8', isDerived: false, isMultivalued: false, isOptional: false, isComposite: false, isUnique: false } );
    var attribute9 = stage.factory.attribute( { x: 225, y: 100, name: 'attribute9', isDerived: false, isMultivalued: false, isOptional: false, isComposite: true,  isUnique: false } );
    var attribute10 = stage.factory.attribute( { x: 225, y: 100, name: 'attribute10', isDerived: false, isMultivalued: false, isOptional: false, isComposite: false, isUnique: false } );
    var attribute11 = stage.factory.attribute( { x: 225, y: 100, name: 'attribute11', isDerived: false, isMultivalued: false, isOptional: false, isComposite: false, isUnique: false } );
    var attribute12 = stage.factory.attribute( { x: 225, y: 100, name: 'attribute12', isDerived: false, isMultivalued: false, isOptional: false, isComposite: false, isUnique: false } );

    var entity1 = stage.factory.entity( { x: 100, y: 100, name: 'entity1', type: 'regular' } );
    var entity2 = stage.factory.entity( { x: 100, y: 100, name: 'entity2', type: 'weak' } );
    var entity3 = stage.factory.entity( { x: 100, y: 100, name: 'entity3', type: 'associative' } );
    var entity4 = stage.factory.entity( { x: 100, y: 100, name: 'entity4', type: 'regular' } );

    stage.addItem(entity1);
    stage.addItem(entity2);
    stage.addItem(entity3);
    stage.addItem(entity4);

    stage.addItem(attribute1);
    stage.addItem(attribute2);
    stage.addItem(attribute3);
    stage.addItem(attribute4);
    stage.addItem(attribute5);
    stage.addItem(attribute6);
    stage.addItem(attribute7);
    stage.addItem(attribute8);
    stage.addItem(attribute9);
    stage.addItem(attribute10);
    stage.addItem(attribute11);
    stage.addItem(attribute12);

    stage.connect.items(entity1, attribute1);
    stage.connect.items(entity1, attribute2);
    stage.connect.items(entity1, attribute3);
    stage.connect.items(entity1, attribute4);
    stage.connect.items(entity1, attribute6);

    stage.connect.items(entity2, attribute5);
    stage.connect.items(attribute5, attribute7);
    stage.connect.items(attribute5, attribute8);

    stage.connect.items(attribute9, attribute10);
    stage.connect.items(attribute9, attribute11);

    var aaa = {
      minimum: 0,
      maximum: 1,
      participation: 'mandatory',
      cardinality: 'many',
      role: 'aaa',
      entityId: entity1.details.id
    }

    var bbb = {
      minimum: 0,
      maximum: 1,
      participation: 'mandatory',
      cardinality: 'one',
      role: 'bbb',
      entityId: entity4.details.id
    };

    var ccc = {
      minimum: 0,
      maximum: 1,
      participation: 'optional',
      cardinality: 'many',
      role: 'ccc',
      entityId: entity2.details.id
    };

    var ddd = {
      minimum: 0,
      maximum: 1,
      participation: 'optional',
      cardinality: 'one',
      role: 'ddd',
      entityId: entity3.details.id
    };

    var relationship1 = stage.factory.relationship( { x: 100, y: 175, name: 'relationship1', isIdentifying: false, slots: [aaa, bbb] } );
    var relationship2 = stage.factory.relationship( { x: 100, y: 175, name: 'relationship2', isIdentifying: true,  slots: [ccc, ddd] } );

    stage.addItem(relationship1);
    stage.addItem(relationship2);

    stage.connect.items(relationship2, attribute12);

    stage.connect.items(entity1, relationship1);
    stage.connect.items(entity4, relationship1);
    stage.connect.items(entity2, relationship2);
    stage.connect.items(entity3, relationship2);

  };

  erd.samples.createLabels = function(stage) {
    var label = stage.factory.label({
      text: 'Here is a sample label and the text here is going to require multiple lines to display properly.'
    });
    stage.addItem(label);
  };

})();
